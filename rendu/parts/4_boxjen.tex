\section{Prévision selon la méthodologie de Box \& Jenkins}\label{sec:bj}
\subsection{Présentation de la méthode}
Lors de des prévisions faites grace aux méthodes traditionnelles, il a été possible de montrer que les résidus des prévisions n'étaient pas des bruits blancs. En effet, 
les méthodes traditionnelle s'avèrent le plus souvent inefficaces lors de prévisions de chroniques économiques, en particulier financières. Une partie des informations est 
donc perdue, mal modélisée par les lissages ou extrapolations. Une autre classe de méthodes de modélisation de séries temporelles peut donc être utilisée pour modéliser le 
cours du blé et du nickel : les processus aléatoires ARMA.\\[11pt]
La démocratisation de l'utilisation des processus aléatoires dans le domaine de la modélisation économique remonte aux années 1970. À cette époque, deux statisticiens, 
George Box et Gwilym Jenkins mettent au point une méthode itérative de prévision de séries temporelles basée sur les processus aléatoires ARMA. \\[11pt]
La première étape de cet algorithme est de transformer la série de base, c'est à dire procéder a une transformation logarithmique en cas de fortes variations, corriger les 
variations saisonnières en cas de saisonnalité, et finalement corriger la tendance si il y en à une. Cette étape de transformation vise donc à rendre stationnaire une 
série temporelle pour que ses caractéristiques se rapprochent le plus à celles d'un processus ARMA. En effet, la méthodologie de Box et Jenkins est bâtie sur la 
modélisation de chroniques stationnaires, or les séries économiques ou financières sont rarement la réalisation de de processus aléatoires stationnaires. Il faut donc 
réaliser un test de racine unitaire pour déterminer si la série est stationnaire ou non, et si elle ne l'est pas, identifier le type de non-stationnarité.\\[11pt]
Les types de processus non-stationnaires les plus fréquents sont :
\begin{itemize}
    \item \textbf{Les processus DS}  (\textit{Differency Stationary} ) représentent la non-stationnarité aléatoire, forme la plus commune des chroniques financières.
    \item \textbf{Les processus TS}  (\textit{Trend Stationary} ) représentent la non-stationnarité déterministe.
\end{itemize}
Si la série est un DS, il faut appliquer un filtre aux différences pour corriger la stationnarité. Au contraire si c'est un TS, la stationnarité est corrigée par la 
méthode des moindres carrés ordinaires.\\[11pt]
Lorsque la série est stationnaire, vient alors l'étape d'identification. Les caractéristiques des fonctions d'autocorrélation et autocorrélation partielle de la chronique
sont comparées à celles de processus ARMA théoriques, ceci permet d'identifier l'ordre du processus ARMA sous-jacent.\\[11pt]
La troisième étape est l'étape d'estimation, les paramètres du processus ARMA identifié sont estimés par la méthode des MCO. Pour rappel, un ARMA($p,q$) est une 
combinaison linéaire de processus autorégressif à l'ordre $p$ AR($p$) et de processus moyenne mobile à l'ordre $q$ MA($q$) tel que :
\begin{equation*}
    x_t = \varepsilon_t +  \sum_{i=1}^p \phi_i x_{t-i} + \sum_{i=1}^q \theta_i \varepsilon_{t-i}
\end{equation*}
Une fois que les paramètres du modèle ont été estimés, s'en suit l'étape de tests de validation du modèle. En effet, si le modèle ne répond pas aux critères attendus 
d'un bon modèle ARMA, alors il faut revenir à l'étape d'identification afin d'identifier si possible, un meilleur modèle. Ces critères peuvent être classés de la sorte :
\begin{itemize}
    \item Minimisation des critères d'information construits pour les ARMA.
    \item Stationnarité de la partie AR et inversibilité de la partie MA.
    \item Significativité des paramètres estimés et du coefficient de détermination.
    \item Les résidus suivent un bruit blanc gaussien.
    \item Respect du principe de parcimonie.
\end{itemize}
Si le modèle estimé respecte la majorité des éléments de la liste, il alors est possible de passer à la cinquième et dernière étape : la prévision. Une fois la prévision
faite, il est nécessaire de recolorer la chronique, c'est à dire re-transformer la chronique à son état d'origine.\\[11pt]
Maintenant que les étapes de l'algorithme ont été explicitées, ce dernier est utilisé afin de prévoir les valeurs des cours du blé et du nickel. La stratégie est 
sensiblement la même que celle de la partie~\ref{sec:tradi}, c'est à dire : une prévision pour 2022 grace aux échantillons 2016-2019, puis une prévision pour 2022 grace 
aux échantillons 2016-2021, les échantillons utilisés étant ceux ayant été transformés logarithmiquement et corrigés des variations saisonnières si besoin. Les meilleurs 
modèles seront par la suite comparés aux méthodes traditionnelles afin de déterminer la méthode a utiliser pour prévoir 2023.
\subsection{Test de racine unitaire}
La type de non-stationnarité revêt une grande importance lorsqu'il s'agit de traiter des données statistiques d'une série temporelle. Pour cela qu'il est
primordial d'identifier si la chronique est un DS ou un TS, une mauvaise stationnarisation pouvant grandement fausser les résultats. Plusieurs tests permettent de
répondre à cette problématique, ce sont les tests de recherche de racine unitaire, parmi eux, le premier à avoir été mis au point est celui de Dickey-Fuller. Pour ce
travail, le test de Philip-Perron est utilisé, il s'agit d'une extension de celui de Dickey-Fuller qui permet de permet de prendre en compte les erreurs hétéroscédastiques 
et/ou autocorrélées.\\[11pt]
La stratégie de test de Philip-Perron est la même que celle du test de Dickey-Fuller augmenté, elle consiste en une estimation séquentielle de trois modèles : un AR(1) 
avec tendance et constante, un AR(1) avec constante, et un AR(1) simple. À chacune des étapes deux tests sont faits :
\begin{itemize}
    \item Un test de présence de racine unitaire $H_{0}$ (l'hypothèse alternative $H_{1}$ étant stationnarité de la chronique).
    \item Un test d'hypothèse jointe, permettant de valider la présence de racine unitaire et de différencier TS et DS. 
\end{itemize}
%
\subsubsection{Echantillon 2016-2019}
Dans un premier temps, la stratégie de test de racine unitaire est fait sur les échantillons 2016-2019 des cours du blé et du nickel\footnote{Voir annexe~\ref{appendix:ru_19} p.~\pageref{appendix:ru_19}}.
\subsubsection*{$\bullet$ Test de racine unitaire sur le cours blé}
Le modèle 3 est estimé, c'est un AR(1) avec tendance et constante :
\begin{equation*}
    x_{t} = c + bt + \phi_{1} x_{t-1} + a_{t}
\end{equation*}
L'hypothèse de présence de racine unitaire est testée.
%
\begin{itemize}
\item[-]\textbf{ Hypothèse :} 
\begin{align*}
    H_{0} &: \phi_{1} = 1  & &\text{Présence de racine unitaire.}\\
    H_{1} &:|\phi_{1}| < 1   &  &\text{Stationnarité du processus.}
\end{align*}
\item[-]\textbf{Statistique de test :} 
\begin{equation*}
    t_{c} = \frac{\tilde{\phi}_{1}- 1}{\hat{\sigma}_{\tilde{\phi}_{1}}}
\end{equation*}
\item[-]\textbf{Règle de décision :} Pour un niveau de test à 5\%, la statistique de Student calculée est ensuite comparée à la statistique de student ajustée de la table 
de Dickey-Fuller (annexe). Si la statistique calculée est supérieure au seuil, alors l'hypothèse nulle de présence de racine unitaire est acceptée.
\item[-]\textbf{Application :} 
\begin{equation*}
    t_{c} = -2,67
\end{equation*}
D'autre part, la statistique de Student ajustée lue dans la table de Dickey-Fuller est $t_{ajs} = - 3,51$. La statistique calculée est donc supérieure au seuil critique,
l'hypothèse $H_{0}$ est acceptée au risque de 5\%, il y a présence de racine unitaire.
\end{itemize}
%
Afin de distinguer TS de DS, il faut a présent tester l'hypothèse jointe $H_{0}^{3}$
%
\begin{itemize}
\item[-]\textbf{Spécification du test :} 
\begin{equation*}
    \begin{split}
        H_{0}^{3} &: (c; b; \phi_{1}) = (c;0;1)\\
        H_{1}^{3} &: \text{Au moins un des paramètres est différent.}
    \end{split}
\end{equation*}
\item[-]\textbf{Statistique de test :} 
\begin{equation*}
    F_{3} = \frac{(SCR_{c}^{3} - SCR_{3})/2}{SCR_{3}/(n-3)}
\end{equation*}
Où $SCR_{3}$ est la somme des carrés des résidus du modèle 3 et $SCR_{c}^{3}$ la somme des carrés des résidus du modèle 3 contraint sous l'hypothèse $H_{0}^{3}$ tel que :
$SCR_{c}^{3} = \sum_{t} \left(x_{t} - x_{t-1} - \hat{c}\right)^{2}$.
\item[-]\textbf{Règle de décision :} La statistique de Fisher calculée est par la suite comparée à la statistique de Fisher tabulée de Dickey-Fuller. Si $F_{3}$ est 
inférieur au seuil critique lu dans la table pour un niveau de test à 5\%, alors $H_{0}^{3}$ est acceptée.
\item[-]\textbf{Application :} 
\begin{equation*}
    F_{3} = \frac{(0,100994 -  0,087023)/2}{0,087023/(47-3)} = 3,53
\end{equation*}
La statistique lue dans la table de Dickey-Fuller est $\Phi_{3} = 6,73$; or $F_{3}$ est inférieure à $\Phi_{3}$. L'hypothèse $H_{0}^{3}$ Est donc acceptée au risque 
de 5\%.
\end{itemize}
%
En suivant le diagramme de stratégie de test de racine unitaire, il est désormais nécessaire de tester l'hypothèse jointe $H_{0}^{2}$.
%
\begin{itemize}
\item[-]\textbf{Spécification du test :} 
\begin{equation*}
    \begin{split}
        H_{0}^{2} &: (c; b; \phi_{1}) = (0;0;1)\\
        H_{1}^{2} &: \text{Au moins un des paramètres est différent.}
    \end{split}
\end{equation*}
\item[-]\textbf{Statistique de test :}
\begin{equation*}
    F_{2} = \frac{(SCR_{c} - SCR_{3})/3}{SCR_{3}/(n-3)}
\end{equation*}
Où $SCR_{c}$ est la somme des carrés des résidus du modèle 3 contraint sous l'hypothèse $H_{0}^{2}$, il s'agira donc ici de la somme des carrés de la différence première
du cours en log du blé.
\item[-]\textbf{Règle de décision :}  Si la statistique $F_{2}$ est inférieure à la statistique lue dans la table de Dickey-Fuller pour un niveau de test de 5\%, alors $H_{0}^{2}$ est acceptée.
\item[-]\textbf{Application :} 
\begin{equation*}
    F_{2} = \frac{(0,101423 - 0,087023)/3}{0,087023/(47-3)} = 2,43
\end{equation*}
De plus, la statistique de Fisher lue dans la table de Dickey-Fuller $\Phi_{2} = 5,13$ est supérieure à la statistique calculée. L'hypothèse $H_{0}^{2}$ est donc acceptée
au risque de 5\%. 
\end{itemize}
%
Pour le moment, d'après le diagramme, le cours du blé ne peut pas être un TS. Il est maintenant nécessaire d'estimer le modèle 2, qui est identique au modèle 3 à 
l'exception de l'absence de tendance.
\begin{equation*}
    x_{t} = c + \phi_{1} x_{t-1} + a_{t}
\end{equation*}
De manière séquentielle, comme pour le modèle 3, l'hypothèse de présence de racine unitaire est testée.
%
\begin{itemize}
\item[-]\textbf{ Hypothèse :} 
\begin{align*}
        H_{0} &: \phi_{1} = 1  & &\text{Présence de racine unitaire.}\\
        H_{1} &:|\phi_{1}| < 1   &  &\text{Stationnarité du processus.}
\end{align*}
\item[-]\textbf{Statistique de test :} 
\begin{equation*}
    t_{c} = \frac{\tilde{\phi}_{1}- 1}{\hat{\sigma}_{\tilde{\phi}_{1}}}
\end{equation*}
\item[-]\textbf{Règle de décision :} La statistique de student calculée est comparée à la statistique de student tabulée de Dickey-Fuller pour un niveau de test à 
5\%. Si la statistique calculée est supérieure au seuil critique, alors l'hypothèse nulle de présence de racine unitaire est acceptée.
\item[-]\textbf{Application :} 
\begin{equation*}
    t_{c} = -1,73 > t_{ajs} = -2,93
\end{equation*}
L'hypothèse $H_{0}$ est donc acceptée au risque de 5\%, il y a présence de racine unitaire.
\end{itemize}
%
Un test d'hypothèse jointe $H_{0}^{1}$ est ensuite fait afin de valider la présence de racine unitaire et tester la nullité de la constante $c$.
\begin{itemize}
\item[-]\textbf{Spécification du test :} 
\begin{equation*}
    \begin{split}
        H_{0}^{1} &: (c; \phi_{1}) = (0;1)\\
        H_{1}^{1} &: \text{Au moins un des paramètres est différent.}
    \end{split}
\end{equation*}
\item[-]\textbf{Statistique de test :}
\begin{equation*}
    F_{1} = \frac{(SCR_{c} - SCR_{2})/2}{SCR_{2}/(n-2)}
\end{equation*}
Où $SCR_{2}$ est la somme des carrés des résidus du modèle 2 non contraint.
\item[-]\textbf{Règle de décision :}  Si la statistique $F_{2}$ est inférieure à la statistique lue dans la table de Dickey-Fuller pour un niveau de test de 5\%, alors 
$H_{0}^{2}$ est acceptée.
\item[-]\textbf{Application :} 
\begin{equation*}
    F_{1} = \frac{(0,101423 - 0,094683)/2}{0,094683/(47-2)} = 1,60
\end{equation*}
Cette statistique est inférieure à la statistique de Fisher lue dans la table de Dickey-Fuller $\Phi_{1} = 4,86$. L'hypothèse $H_{0}^{2}$ est donc acceptée au risque 
de 5\%. 
\end{itemize}
%
D'après le diagramme, il faut maintenant tester la nullité de la moyenne du cours du blé. En effet, si il s'avère que la moyenne n'est pas nulle alors le processus 
sous-jacent est un DS.
\begin{itemize}
    \item[-]\textbf{Spécification du test :}
\begin{align*}
    H_{0} &: \mu = 0 & H_{1} &: \mu \neq 0
\end{align*}
\item[-]\textbf{Règle de décision :} La statistique calculé est un student et elle est comparée à la distribution bilatérale de la loi de Student qui converge vers une loi normale centrée réduite. Si la statistique calculée est inférieure à 1,96, alors $H_{0}$ est acceptée au risque de 5\%.
\item[-]\textbf{Application :} Ici $t_{c} = 400 > 1,96$, l'hypothèse de nullité de la moyenne est donc rejetée au risque de 5\%.
\end{itemize}
La moyenne du cours du blé n'étant pas nulle, il est possible de conclure que le processus générateur de la chronique est un DS sans dérive $\Delta x_{t} = a_{t}$. Pour le 
rendre stationnaire il est donc nécessaire d'appliquer un filtre aux différences premières. Soit $x_{t}$ le cours du blé.
\begin{equation*}
    \begin{split}
        \Delta x_{t} &= \ln x_{t} - \ln x_{t-1} \\
        &= \ln\left(\frac{x_{t}}{x_{t-1}}\right)
    \end{split}
\end{equation*}
Ici $\Delta x_{t}$ correspond aux rendements logarithmiques du cours du blé.
\subsubsection*{$\bullet$ Test de racine unitaire sur le cours nickel}
%
La même stratégie (annexe) est utilisée afin de déterminer si le cours du nickel est stationnaire, et dans le cas contraire, identifier le type de non-stationnarité.
Dans un premier temps, le modèle 3 est estimé, c'est un AR(1) avec tendance et constante. À partir de ce modèle l'hypothèse de présence de racine unitaire est ensuite 
testée.
%
\begin{itemize}
\item[-]\textbf{ Hypothèse :} 
\begin{align*}
    H_{0} &: \phi_{1} = 1  & &\text{Présence de racine unitaire.}\\
    H_{1} &:|\phi_{1}| < 1   &  &\text{Stationnarité du processus.}
\end{align*}
\item[-]\textbf{Statistique de test :} 
\begin{equation*}
    t_{c} = \frac{\tilde{\phi}_{1}- 1}{\hat{\sigma}_{\tilde{\phi}_{1}}} = -3,04
\end{equation*}
\item[-]\textbf{Règle de décision :} La statistique calculée est comparée au seuil critique lu dans la table de Dickey-Fuller (annexe). Si la statistique calculée est supérieure à ce seuil, alors l'hypothèse de présence de racine unitaire est acceptée.
\item[-]\textbf{Application :} La statistique de student ajustée lue dans la table de Dickey-Fuller est $t_{ajs} = - 3,51$. Or $t_{c} > t_{ajs}$, $H_{0}$ est acceptée 
au risque de 5\%, il y a une racine unitaire.
\end{itemize}
%
Il est maintenant nécessaire de tester l'hypothèse jointe pour différencier TS de DS.
%
\begin{itemize}
\item[-]\textbf{Spécification du test :} 
\begin{equation*}
    \begin{split}
        H_{0}^{3} &: (c; b; \phi_{1}) = (c;0;1)\\
        H_{1}^{3} &: \text{Au moins un des paramètres est différent.}
    \end{split}
\end{equation*}
\item[-]\textbf{Statistique de test :} 
\begin{equation*}
    F_{3} = \frac{(SCR_{c}^{3} - SCR_{3})/2}{SCR_{3}/(n-3)} = 4,44
\end{equation*}
\item[-]\textbf{Règle de décision :} La statistique calculée est comparée à celle lue dans la table de Dickey-Fuller. Si $F_{3}$ est inférieure à celle lue pour un niveau 
de 5\%, alors $H_{0}^{3}$ est acceptée.
\item[-]\textbf{Application :} La statistique lue dans la table de Dickey-Fuller est $\Phi_{3} = 6,73$; or $F_{3} < \Phi_{3}$. L'hypothèse $H_{0}^{3}$ est acceptée au 
risque de 5\%.
\end{itemize}
%
L'hypothèse jointe $H_{0}^{2}$ est testée.
%
\begin{itemize}
\item[-]\textbf{Spécification du test :} 
\begin{equation*}
    \begin{split}
        H_{0}^{2} &: (c; b; \phi_{1}) = (0;0;1)\\
        H_{1}^{2} &: \text{Au moins un des paramètres est différent.}
    \end{split}
\end{equation*}
\item[-]\textbf{Statistique de test :}
\begin{equation*}
    F_{2} = \frac{(SCR_{c} - SCR_{3})/3}{SCR_{3}/(n-3)} = 3,19
\end{equation*}
\item[-]\textbf{Règle de décision :}  Si la statistique $F_{2} < \Phi_{2}$ pour un niveau de test de 5\%, alors $H_{0}^{2}$ est acceptée.
\item[-]\textbf{Application :} $F_{2} < \Phi_{2} = 5,13 $. Alors $H_{0}^{2}$ est acceptée au risque de 5\%. 
\end{itemize}
%
Le cours du nickel ne peut pas être considéré comme un TS. Par conséquent, il faut estimer le modèle 2. Il convient ensuite de tester l'hypothèse de présence de racine
unitaire
%
\begin{itemize}
\item[-]\textbf{ Hypothèse :} 
\begin{align*}
        H_{0} &: \phi_{1} = 1  & &\text{Présence de racine unitaire.}\\
        H_{1} &:|\phi_{1}| < 1   &  &\text{Stationnarité du processus.}
\end{align*}
\item[-]\textbf{Statistique de test :} 
\begin{equation*}
    t_{c} = \frac{\tilde{\phi}_{1}- 1}{\hat{\sigma}_{\tilde{\phi}_{1}}} = -1,81
\end{equation*}
\item[-]\textbf{Règle de décision :} Si pour un niveau de test à 5\%, le student calculé est supérieur au student ajusté de Dickey-Fuller alors $H_{0}$ est acceptée.
\item[-]\textbf{Application :} $t_{c} > t_{ajs} = -2.93$. Alors $H_{0}$ est acceptée au risque de 5\%.
\end{itemize}
%
Afin de valider la présence de racine unitaire ainsi que tester la significativité de la constante, le test d'hypothèse jointe $H_{0}^{1}$ est fait.
\begin{itemize}
\item[-]\textbf{Spécification du test :} 
\begin{equation*}
    \begin{split}
        H_{0}^{1} &: (c; \phi_{1}) = (0;1)\\
        H_{1}^{1} &: \text{Au moins un des paramètres est différent.}
    \end{split}
\end{equation*}
\item[-]\textbf{Statistique de test :}
\begin{equation*}
    F_{1} = \frac{(SCR_{c} - SCR_{2})/2}{SCR_{2}/(n-2)} = 2,16
\end{equation*}
\item[-]\textbf{Règle de décision :}  Si la statistique $F_{1} < \Phi_{1}$ pour un niveau de test de 5\%, alors $H_{0}^{1}$ est acceptée.
\item[-]\textbf{Application :} $F_{1} < \Phi_{1} = 4,86 $. Alors $H_{0}^{1}$ est acceptée au risque de 5\%.
\end{itemize}
%
Un test de nullité de la moyenne du cours du nickel est fait :
\begin{itemize}
    \item[-]\textbf{Spécification du test :}
\begin{align*}
    H_{0} &: \mu = 0 & H_{1} &: \mu \neq 0
\end{align*}
\item[-]\textbf{Règle de décision :} Si $t_{c} < U_{0,95}$, alors $H_{0}$ est acceptée au risque de 5\%.
\item[-]\textbf{Application :} Ici $t_{c} = 340 > 1,96 $. Donc $H_{0}$ est rejetée au risque de 5\%.
\end{itemize}
La moyenne du cours du nickel n'est donc pas nulle, d'après le diagramme de stratégie de test de racine unitaire, le processus sous-jacent est un DS sans dérive. Un filtre 
aux différences premières est appliqué pour le rendre stationnaire.
\subsubsection{Echantillon 2016-2021}
Le même procédé que dans la partie précédente est utilisé pour déterminer si les échantillons incluant la période Covid-19 sont stationnaires ou non, et dans le cas 
échéant quel est type de non stationnarité.\\[11pt]
Les séries étant les mêmes que celles testées précédemment seulement rallongées de deux ans, cela laisse à penser que les processus générateurs des échantillons 
2016-2021 soient aussi des DS sans dérive. Pour éviter toute redondance, les deux tests seront donc synthétisés en un 
seul\footnote{Voir annexe~\ref{appendix:ru_21} p.~\pageref{appendix:ru_21}}.\\[11pt]
Le modèle 3 est estimé, puis test de racine unitaire $H_{0}$ est fait.
\begin{itemize}
    \item[-]\textbf{Spécification du test :} 
    \begin{align*}
        H_{0} &: \text{ Présence de racine unitaire.} & H_{1} &: \text{ Stationnarité du processus.}
    \end{align*}
    \item[-]\textbf{Statistique de test :} 
    \begin{multicols}{2}
    \centering Blé
    \begin{align*}
            t_{c} &= -2,73 & &> & t_{ajs} &= -3,47
    \end{align*}

    \columnbreak

    \centering Nickel
    \begin{align*}
        t_{c} &=  -2.83  & &> & t_{ajs} &= -3,47
    \end{align*}
    \end{multicols}
    \item[-]\textbf{Règle de décision :} $H_{0}$ acceptée au risque de 5\% pour les deux. Il y a racine unitaire dans les deux cas.
    \end{itemize}
    %
    Test d'hypothèse jointe $H_{0}^{3}$.
    %
    \begin{itemize}
    \item[-]\textbf{Spécification du test :} 
    \begin{equation*}
        H_{0}^{3} : (c; b; \phi_{1}) = (c;0;1)\\
    \end{equation*}
    \item[-]\textbf{Statistique de test :} 
    \begin{multicols}{2}
        \centering Blé
        \begin{align*}
            F_{3} &= 4,27  & &< & \Phi_{3} &= 6,49
        \end{align*}
    
        \columnbreak
    
        \centering Nickel
        \begin{align*}
            F_{3} &= 4,05  & &< & \Phi_{3} &= 6,49
        \end{align*}
    \end{multicols}
    \item[-]\textbf{Règle de décision :} $F_{3} < \Phi_{3}$ , alors $H_{0}^{3}$ est acceptée au risque de 5\% pour les deux échantillons, il y a racine unitaire et le 
    paramètre de pente est nulle.
    \end{itemize}
    %
    Test d'hypothèse jointe $H_{0}^{2}$.
    %
    \begin{itemize}
    \item[-]\textbf{Spécification du test :} 
    \begin{equation*}
        H_{0}^{2} : (c; b; \phi_{1}) = (0;0;1)\\
    \end{equation*}
    \item[-]\textbf{Statistique de test :}
    \begin{multicols}{2}
        \centering Blé
        \begin{align*}
            F_{2} &= 3,29  & &< & \Phi_{2} &= 4,88
        \end{align*}
    
        \columnbreak
    
        \centering Nickel
        \begin{align*}
            F_{2} &= 3,47  & &< & \Phi_{2} &= 4,88
        \end{align*}
    \end{multicols}  
    \item[-]\textbf{Règle de décision :} $F_{2} < \Phi_{2}$ , alors $H_{0}^{2}$ est acceptée au risque de 5\% pour les deux échantillons, la constante du modèle n'est pas
    significative.
    \end{itemize}
    %
    Le modèle 2 est estimé, par la suite, un test de racine unitaire $H_{0}$ est fait.
    %
    \begin{itemize}
    \item[-]\textbf{Spécification du test :} 
    \begin{align*}
        H_{0} &: \text{ Présence de racine unitaire.} & H_{1} &: \text{ Stationnarité du processus.}
    \end{align*}
    \item[-]\textbf{Statistique de test :} 
    \begin{multicols}{2}
    \centering Blé
    \begin{align*}
            t_{c} &= -0,19  & &> & t_{ajs} &= -2,90
    \end{align*}

    \columnbreak

    \centering Nickel
    \begin{align*}
        t_{c} &= -0,73  & &> & t_{ajs} &= -2,90
    \end{align*}
    \end{multicols}
    \item[-]\textbf{Règle de décision :} $H_{0}$ acceptée au risque de 5\% pour les deux. Il y a racine unitaire dans les deux cas.
    \end{itemize}
    Test d'hypothèse jointe $H_{0}^{1}$.
    \begin{itemize}
    \item[-]\textbf{Spécification du test :} 
    \begin{equation*}
            H_{0}^{1} : (c; \phi_{1}) = (0;1)\\
    \end{equation*}
    \item[-]\textbf{Statistique de test :}
    \begin{multicols}{2}
        \centering Blé
        \begin{align*}
            F_{1} &= 0,77 & &< & \Phi_{1} &= 4,71
        \end{align*}
    
        \columnbreak
    
        \centering Nickel
        \begin{align*}
            F_{1} &= 1,26 & &< & \Phi_{1} &= 4,71
        \end{align*}
    \end{multicols}  
    \item[-]\textbf{Règle de décision :}  $F_{1} < \Phi_{1}$ , alors $H_{0}^{1}$ acceptée au risque de 5\% pour les deux échantillons, la constante du modèle n'est pas
    significative
    \end{itemize}
    %
    Test de nullité de la moyenne
    \begin{itemize}
        \item[-]\textbf{Spécification du test :}
    \begin{align*}
        H_{0} &: \mu = 0 & H_{0} &: \mu \neq 0
    \end{align*}
    \item[-]\textbf{Statistique de test :}
    \begin{multicols}{2}
        \centering Blé
        \begin{equation*}
                t_{c} = 287,06
        \end{equation*}
    
        \columnbreak
    
        \centering Nickel
        \begin{equation*}
            t_{c} = 267,5
        \end{equation*}
        \end{multicols}
    \item[-]\textbf{Règle de décision :} $t_{c} > 1,96$, Pour les deux échantillons, $H_{0}$ est rejetée au risque de 5\%, la moyenne n'est pas significative.
    \end{itemize}
Le résultat est donc le même que celui trouvé précédemment, les processus générateurs du cours du blé et du nickel sur la période 2016-2021 ne sont pas stationnaires et 
sont des DS sans dérive. Il faut appliquer un filtre aux différences premières afin de rendre stationnaire les séries.
\subsection{Identification, validation et prévision des processus}
La seconde étape de l'algorithme de Box et Jenkins est l'étape d'identification. En effet dès lors qu'un série chronologique a été rendue stationnaire, il est
nécessaire d'identifier le processus ARMA le plus apte à s'assimiler aux données empiriques. 
Pour cela l'identification d'un processus ARMA se fait par la comparaison des fonctions d' autocorrélation et d'autocorrélation partielle de la série à celles de processus 
ARMA théoriques. En somme, un processus ARMA sera choisi si les FAC et FAP de ce dernier sont semblables à celle observées sur les cours du blé et du nickel (en 
différences premières).\\[11pt]
Cependant, avant d'analyser les fonctions d'autocorrélation, il est courant de réaliser un test BDS sur une série stationnaire afin de déterminer si elle est 
indépendante statistiquement et identiquement distribué (\textit{i.i.d}). En effet si la série est indépendante et \textit{i.i.d}, sa modélisation par processus aléatoire 
ARMA est impossible.Le test est fait pour les quatres échantillons\footnote{Voir annexe~\ref{appendix:bds} p.~\pageref{appendix:bds}}.\\
\textbf{Spécification du test :} 
\begin{equation*}
    H_{0} : \text{ La chronique est indépendant et \textit{i.i.d}}
\end{equation*}
\textbf{Règle de décision :} Concernant le blé, pour l'échantillon 2016-2019 , la majorité des probabilités d'accepter $H_{0}$ sont inférieures à 5\%, $H_{0}$ est donc 
rejetée pour cet échantillon. Pour celui allant jusqu'a 2021 les probabilités sont toutes inférieures à 5\% pour toutes les dimensions $H_{0}$ est également rejetée.
Le cours du blé (tout échantillon confondu) n'est donc pas indépendant et \textit{i.i.d}, il est possible de le modéliser grace à des processus ARMA.\\[11pt]
En revanche, pour le nickel, sur les deux échantillons la grande majorité des probabilités d'accepter $H_{0}$ sont supérieures à 5\%, dans les deux cas $H_{0}$ est donc 
acceptée, le cours du nickel est indépendant et \textit{i.i.d}, il est impossible de modéliser le cours grace à des processus ARMA. La prévision du cours du nickel grace aux processus aléatoire s'arrête donc ici.

\subsubsection{Echantillon 2016-2019}
Pour le blé, l'étude du corrélogramme\footnote{Voir figure~\ref{fig:cor_dble19} p.~\pageref{fig:cor_dble19}} révèle des coefficients significatif au premier retard de la 
FAC et de la PAC. Cette configuration pourrait donc faire penser à celle d'un ARMA(1,1). Cependant, il serait aussi judicieux de considérer la possibilité que le processus 
puisse être identifié comme un AR(1) ou un MA(1). Afin de discriminer le modèle le plus pertinent, 36 simulations de modèles ARMA sont faites (les ordres des processus 
allant de 0 à 5, par respect du principe de parcimonie). Le modèle choisi sera celui le plus apte à répondre à ces trois problématiques : 
\begin{enumerate}
    \item Minimisation du critère d'Akaike.
    \item Significativité des paramètre(s) du modèle.
    \item Qualité des résidus (non autocorrélation, homoscédasticité, normalité).
\end{enumerate}
Grace à la table\footnote{Voir tableau ~\ref{fig:arma_heatmap_19} p.~\pageref{fig:arma_heatmap_19}}, il est rapidement possible de déterminer que le modèle répondant aux 
problématiques précédentes est un AR(1). En effet, le modèle minimise le 
critère d'Akaike, Le paramètre est significatif et les résidus suivent un bruit blanc gaussien\footnote{Voir annexe ~\ref{appendix:valid19} p.~\pageref
{appendix:valid19}}. 
\begin{table}[H]
    \centering
    \caption{Résumé des tests de validation du modèle AR(1) estimé pour le blé (2016-2019)}
    \sffamily
    \begin{tabular}{llcc}
    \toprule
    \multicolumn{1}{c}{Hypothèse nulle ($H_{0}$)} & \multicolumn{1}{c}{Test} & Valeur-$p$      & Decision \\
    \midrule
    Paramètre non significatif              & Student       &    0,04       &  Rejetée  \\
    Absence d'autocorrelation des résidus   & Ljung-Box     &    >0,05      &  Acceptée \\
    Homoscédasticité des résidus            & ARCH          &    0,44       &  Acceptée \\
    Normalité des résidus                   & Jarque-Bera   &    0,93       &  Acceptée \\
    \bottomrule
    \end{tabular}
\end{table}
Le modèle est donc utilisé afin de prévoir l'année 2022.
\begin{equation*}
\begin{split}
    \Delta x_{t} &= \phi_{1} \Delta x_{t-1} \\
    \Delta x_{t} &=-0,32 \times \Delta x_{t-1}
\end{split}
\end{equation*}
D'après cette modélisation, le rendement logarithmique du blé à l'instant $t$ dépend du rendement logarithmique du mois précédent. Il est cependant bon de remarquer 
que le coefficient $\phi_{1}$ est assez faible, la modélisation étant linéaire, la prévision risque d'être relativement plate.
\begin{table}[H]
    \centering
    \caption{Prévision du cours du blé en 2022 avec échantillon ante-Covid-19}
    \sffamily
    \input{tab/4_3_1_prev.tex}
\end{table}
En effet passé un certain horizon de prévision, la prévision du cours devient totalement constante à 187,95 \euro\ le contrat. Il est envisageable de résoudre ce 
problème en prenant en considération la période de la pandémie de Covid-19 et en réduisant l'horizon de prévision. Par conséquent, il est nécessaire de passer à 
l'échantillon suivant.
\subsubsection{Echantillon 2016-2021}
Le principe est le même que dans la sous-partie précédente. Le corrélogramme\footnote{Voir figure~\ref{fig:cor_dble21}} des rendements logarithmes du blé sur la période
2016-2021 est quasiment le même que celui vu précédemment, c'est à dire, un coefficient significatif au retard 1 sur la FAC et la FAP. En théorie le processus aléatoire 
théorique le plus proche de cette série est donc un ARMA(1,1) ou AR(1) ou MA(1). Comme dans la sous partie précédente, la carte 
thermique\footnote{Voir figure~\ref{fig:arma_heatmap_21} p.~\pageref{fig:arma_heatmap_21}} générée indique le processus ARMA répondant aux problématiques exprimées 
précédemment. Il s'agit (comme pour l'échantillon 2016-2019) d'un AR(1), en effet c'est le modèle qui minimise le critère d'Akaike parmi les autres, le paramètre est
significatif au seuil de 5\%, et les résidus suivent un bruit blanc normal\footnote{Voir annexe~\ref{appendix:valid21} p.~\pageref{appendix:valid21}}.\\[11pt]
Comme pour le modèle précédent, les rendements log du cours du blé a l'instant $t$ dépendent de ceux du mois précédent.
\begin{equation*}
    \begin{split}
        \Delta x_{t} &= \phi_{1} \Delta x_{t-1} \\
        \Delta x_{t} &=-0.31 \times \Delta x_{t-1}
    \end{split}
\end{equation*}
Encore une fois, le coefficient étant assez bas, la prévision risque d'être plate (comme celle obtenue avec l'échantillon 2016-2019).
\begin{table}[H]
    \centering
    \caption{Prévision du cours du blé en 2022 avec échantillon post-Covid-19}
    \sffamily
    \input{tab/4_3_2_prev.tex}
\end{table}
De fait, la prévision ne varie que en centimes d'euros les quatres premiers mois, jusqu'a devenir constante a partir du cinquième.
\subsubsection{Choix de la meilleure méthode}
Les prévisions obtenues à travers la méthode de Box et Jenkins ne semblent pas très exactes. En effet, les prévisions obtenues dans les deux cas sont constantes, ce
scénario semble peu envisageable dans la mesure où dans un contexte de guerre ou bien de réchauffement climatique, le cours du blé ne peut pas stagner. Cependant, il est
nécessaire de comparer les deux prévisions en utilisant le critère MSE et RMSE.
\begin{table}[H]
    \centering
    \caption{Critère MSE et RMSE pour la prévision du cours du blé en 2022}
    \sffamily
    \input{tab/4_3_3_mse.tex}
\end{table}
Ici le MSE de la prévision utilisant l'échantillon post-Covid19 est cinq fois plus petit que celui de la prévision ante-Covid19. La prévision par AR(1) sur l'échantillons
2016-2021 est donc choisie pour être comparée à celles des méthodes traditionnelles. L'ajout de la période Covid19 aura été utile pour prévoir l'année 2022 avec 
l'algorithme de Box et Jenkins.
\subsection{Prévision pour 2023}
Dans une dernière étape de comparaison des méthodes de prévision, les prévisions traditionnelles retenues dans la partie~\ref{sec:tradi} seront comparées à
celles de la méthodologie de Box et Jenkins. La méthode minimisant le critère MSE sera utilisée pour prévoir l'année 2023.\\[11pt]
Dans un premier temps, le cours du nickel n'étant pas modélisable par des processus ARMA, la méthode de prévision pour 2023 est celle choisie en~\ref{sec:mse}, c'est à
dire un \textbf{lissage exponentiel de Holt et Winters sur l'échantillon 2016-2019} . \\[11pt]
Concernant le blé, il s'agit de comparer la prévision grace à un AR(1) sur l'échantillon 2016-2021 à la prévision du lissage exponentiel double sur ce même échantillon.
\begin{table}[H]
    \centering
    \caption{Critère MSE et RMSE pour la prévision pour le cours du blé en 2022}
    \sffamily
    \begin{tabular}{cccc}
        \toprule
        Méthode & MSE   & RMSE \\
        \midrule
        LED &  2609,42 & 51,08  \\
        Box-Jenkins & 5408,62 & 73,54 \\
        \bottomrule
    \end{tabular}%
\end{table}
Ici, la meilleure méthode la méthode minimisant le critère MSE est la méthode traditionnelle du \textbf{lissage exponentiel double sur l'échantillon 2016-2019} . Cette 
méthode est donc retenue afin de prévoir le cours du blé en 2023.\\[11pt]
Finalement, les prévisions pour l'années 2023 du cours des contrats a terme du blé et du Nickel sont :
\begin{table}[H]
    \centering
    \caption{Prévision du cours des contrats à terme sur blé et du nickel en 2023}
    \sffamily
    \input{tab/4_4_prev.tex}
\end{table}
Ici, il a été possible d'obtenir le cours moyen mensuel des trois premiers mois de 2023. La prévision du blé semble grandement surestimer le cours avec des valeurs prévues 
deux fois plus grandes. Concernent le nickel, la prévision parait plus précise que celle du blé. Cependant la prévision est croissante alors que le cours réel 
lui est décroissant pour le moment, il est donc possible que dans les mois à venir le lissage de Holt-Winters surestime le vrai cours. Il est possible de calculer les MSE
et RMSE sur l'année 2023 à titre informatif.
\begin{table}[H]
    \centering
    \caption{Critère MSE et RMSE pour les prévisions de 2023}
    \sffamily
    \begin{tabular}{ccc}
    \toprule
    & Blé &	Nickel \\
    \midrule
    MSE	    &   26840,58    &	22790590,23 \\
    RMSE    &	163,83      &	4773,95 \\
    \bottomrule
    \end{tabular}
\end{table}


